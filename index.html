<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>é«˜çº§å…‰æ£èŠ‚ç‰¹æ•ˆ</title>
<style>
html,body{margin:0;padding:0;overflow:hidden;font-family:Helvetica,sans-serif;}
body{background:#0f0c27;}
canvas{position:absolute;top:0;left:0;}
#textBox{
    position:absolute;top:50px;width:100%;text-align:center;
    font-size:48px;font-weight:bold;color:#ffd6e0;
    text-shadow:0 0 10px #ff88aa,0 0 20px #ff88aa,0 0 40px #ff88aa;
}
#double11{
    position:absolute;top:40px;right:40px;font-size:28px;font-weight:bold;color:#ffd6e0;
    text-shadow:0 0 12px #ff88aa;
}
#cta{
    position:absolute;bottom:60px;width:100%;text-align:center;font-size:22px;font-style:italic;color:#ffcbe6;
}
</style>
</head>
<body>
<canvas id="canvas"></canvas>
<div id="textBox"></div>
<div id="cta">å…‰æ£èŠ‚å¿«ä¹</div>

<audio id="bgm" src="https://yeheihei8284m1.github.io/wff/7537318707513625363.mp3" autoplay muted loop></audio>
<audio id="pop" src="pop.wav"></audio>

<script>
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");
let W=window.innerWidth,H=window.innerHeight;
canvas.width=W;canvas.height=H;

const TARGET_NAME="ç‹è²è²";
const LINES=[
`å•èº«èŠ‚å¿«ä¹ï¼Œ${TARGET_NAME}ï½`,
"å•ç€å‘¢","å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ","ä½ æœ€ç¾","ä½ æœ€å¸…","ä½ æ˜¯è¶…çº§æ— æ•Œå¤§å¯çˆ±",
"éª—ä½ çš„","ç¥ä½ æ—©æ—¥è„±å•ï¼Œä¸æ€¥,,,,,,å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ",
"åˆ«æƒ³è„±å•äº†ï¼Œå’±ä»¬è¿™ç§äººï¼Œä¸€çœ‹å°±è¦é™ªå½¼æ­¤åˆ°80å²","ğŸ˜‰"
];

const hearts=[];
const fireworks=[];
const stars=[];
let lastSpawn=Date.now();
let lineIndex=0;
let typingCursor=0;
let typingText=LINES[lineIndex];
let lastTyping=Date.now();

const textBox=document.getElementById("textBox");
const bgm=document.getElementById("bgm");

let mouseX=W/2,mouseY=H/2;
document.addEventListener("mousemove",e=>{mouseX=e.clientX;mouseY=e.clientY;});
document.addEventListener("touchmove",e=>{mouseX=e.touches[0].clientX;mouseY=e.touches[0].clientY;},{passive:true});
document.body.addEventListener('click',()=>{
    bgm.play();
    spawnHeart(mouseX,mouseY,true);
    spawnFirework(mouseX,mouseY);
});

window.onload(() => {
    bgm.play();
})

// --------------------- è¾…åŠ©å‡½æ•° ---------------------
function random(min,max){return Math.random()*(max-min)+min;}
function hslColor(){return `hsl(${random(0,360)},100%,70%)`;}

// --------------------- èƒŒæ™¯æ˜Ÿæ˜Ÿ ---------------------
for(let i=0;i<150;i++){
    stars.push({x:random(0,W),y:random(0,H),r:random(0.5,1.5),alpha:random(0.1,0.8),delta:random(0.01,0.03)});
}
function updateStars(){
    stars.forEach(s=>{
        s.alpha+=s.delta;if(s.alpha>0.8||s.alpha<0.1)s.delta*=-1;
        ctx.fillStyle=`rgba(255,255,255,${s.alpha})`;
        ctx.beginPath();ctx.arc(s.x,s.y,s.r,0,Math.PI*2);ctx.fill();
    });
}

// --------------------- å¿ƒå½¢ç²’å­ ---------------------
function drawHeart(x,y,size,color){
    ctx.save();ctx.translate(x,y);ctx.scale(size,size);ctx.beginPath();
    for(let t=0;t<Math.PI*2;t+=0.2){
        let xt=16*Math.pow(Math.sin(t),3);
        let yt=-(13*Math.cos(t)-5*Math.cos(2*t)-2*Math.cos(3*t)-Math.cos(4*t));
        ctx.lineTo(xt,yt);
    }
    ctx.closePath();ctx.fillStyle=color;ctx.fill();ctx.restore();
}
function spawnHeart(x=random(80,W-80),y=H-50,big=false){
    hearts.push({
        x:x,y:y,
        size:random(0.8,1.3)*(big?2:1),
        vy:random(-3,-1.5),
        wiggle:random(15,50),
        phase:random()*Math.PI*2,
        birth:Date.now(),
        life:random(4000,9000),
        color:hslColor()
    });
}
function updateHearts(){
    let now=Date.now();
    for(let i=hearts.length-1;i>=0;i--){
        let h=hearts[i];let age=now-h.birth;
        if(age>h.life){hearts.splice(i,1);continue;}
        h.phase+=0.05;h.x+=Math.sin(h.phase*2)*h.wiggle*0.05;h.y+=h.vy*2;
        let alpha=1-age/h.life;
        drawHeart(h.x,h.y,h.size,`hsla(${random(0,360)},100%,70%,${alpha})`);
    }
}

// --------------------- çƒŸèŠ±ç²’å­ ---------------------
function spawnFirework(x,y){
    for(let i=0;i<25;i++){
        fireworks.push({
            x:x, y:y,
            vx:random(-3,3),
            vy:random(-3,3),
            r:random(2,4),
            alpha:1,
            decay:random(0.02,0.05),
            color:hslColor()
        });
    }
}
function updateFireworks(){
    for(let i=fireworks.length-1;i>=0;i--){
        let f=fireworks[i];
        f.x+=f.vx;f.y+=f.vy;f.alpha-=f.decay;
        if(f.alpha<=0){fireworks.splice(i,1);continue;}
        ctx.fillStyle=`hsla(${random(0,360)},100%,70%,${f.alpha})`;
        ctx.beginPath();ctx.arc(f.x,f.y,f.r,0,Math.PI*2);ctx.fill();
    }
}

// --------------------- æ‰“å­—æœºæ–‡å­— ---------------------
function updateTyping(){
    let now=Date.now();
    if(typingCursor<typingText.length && now-lastTyping>50){
        typingCursor++;lastTyping=now;
        textBox.innerHTML=`<span style="color:hsl(${typingCursor*10%360},100%,80%)">${typingText.slice(0,typingCursor)}</span>`+((Math.floor(now/500)%2===0)?" |":"");
        spawnHeart(mouseX,mouseY,false);
    }else if(typingCursor>=typingText.length){textBox.innerHTML=typingText;}
}
function nextLine(){lineIndex=(lineIndex+1)%LINES.length;typingText=LINES[lineIndex];typingCursor=0;lastTyping=Date.now();setTimeout(nextLine,Math.max(2000,typingText.length*50+1200));}

// --------------------- åŠ¨ç”»å¾ªç¯ ---------------------
function animate(){
    ctx.clearRect(0,0,W,H);
    updateStars();
    if(Date.now()-lastSpawn>400){spawnHeart();lastSpawn=Date.now();}
    updateHearts();
    updateFireworks();
    updateTyping();
    requestAnimationFrame(animate);
}

nextLine();
animate();

window.addEventListener("resize",()=>{W=window.innerWidth;H=window.innerHeight;canvas.width=W;canvas.height=H;});
</script>
</body>
</html>
